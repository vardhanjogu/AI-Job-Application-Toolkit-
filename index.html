<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Job Application Toolkit</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the classic, preferred UI/UX */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Light gray background */
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        .container-wrapper {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
            flex-grow: 1;
        }
        .card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        .textarea {
            min-height: 200px;
            resize: vertical;
        }
        .result-box {
            min-height: 100px;
            background-color: #f0f4f8; /* Very light blue/gray for results */
            border-left: 4px solid #3b82f6; /* Blue border for emphasis */
            padding: 1rem;
            border-radius: 8px;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-size: 0.95rem;
        }
        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.5rem;
            margin-top: 1rem;
        }
        .action-button {
            padding: 0.75rem 1rem;
            border-radius: 8px;
            font-weight: 600;
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .action-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 1.5rem;
            height: 1.5rem;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container-wrapper">
        <header class="text-center mb-8">
            <h1 class="text-4xl font-extrabold text-blue-600 mb-2">AI JOB APPLICATION TOOLKIT</h1>
            <p class="text-xl text-gray-500">Generate tailored cover letters and prepare for your interview using AI analysis.</p>
        </header>

        <!-- 1. Provide Job & Candidate Details -->
        <div class="card">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">1. Provide Job & Candidate Details</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Job Description Input -->
                <div>
                    <label for="jobDescription" class="block text-lg font-medium text-gray-700 mb-2">Paste the Job Description (JD) here:</label>
                    <textarea id="jobDescription" placeholder="Paste the full text of the job posting..." class="textarea w-full border border-gray-300 rounded-lg p-3 focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>

                <!-- Resume Input -->
                <div>
                    <label for="resumeText" class="block text-lg font-medium text-gray-700 mb-2">Paste Your Full Resume Text Here:</label>
                    <textarea id="resumeText" placeholder="Include all sections: contact info, experience, education, and skills." class="textarea w-full border border-gray-300 rounded-lg p-3 focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="mt-6">
                <button id="generateCoverLetter" class="action-button bg-indigo-600 text-white w-full mb-4">Generate Cover Letter</button>
                <div class="button-grid">
                    <button id="extractKeySkills" class="action-button bg-green-500 text-white">✨ Analyze JD & Extract Skills</button>
                    <button id="summarizeRoleMission" class="action-button bg-teal-500 text-white">✨ Summarize Role Mission</button>
                    <button id="identifyResumeGaps" class="action-button bg-red-500 text-white">✨ Identify Resume Gaps</button>
                    <button id="generateInterviewQuestions" class="action-button bg-purple-500 text-white">✨ Generate Interview Questions</button>
                    <button id="draftStarResponse" class="action-button bg-sky-500 text-white">✨ Draft STAR Response Idea</button>
                    <button id="draftFollowUpEmail" class="action-button bg-yellow-500 text-gray-900">✨ Draft Follow-up Email</button>
                </div>
            </div>
        </div>

        <!-- 2. AI-Generated Results -->
        <div class="card">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">2. AI-Generated Results</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

                <!-- Primary Result (Cover Letter) -->
                <div class="md:col-span-2">
                    <h3 class="text-xl font-semibold mb-2 text-indigo-600">Custom Cover Letter Draft</h3>
                    <div id="coverLetterOutput" class="result-box">
                        Click 'Generate Cover Letter' to begin.
                    </div>
                </div>

                <!-- Secondary Results (Grid) -->
                <div>
                    <h3 class="text-lg font-semibold mb-2 text-teal-600">Role Mission Summary</h3>
                    <div id="missionOutput" class="result-box">
                        Click 'Summarize Role Mission' for results.
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-2 text-green-600">Key JD Skills</h3>
                    <div id="skillsOutput" class="result-box">
                        Click 'Analyze JD & Extract Skills' for results.
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-2 text-red-600">Identified Resume Gaps</h3>
                    <div id="gapsOutput" class="result-box">
                        Click 'Identify Resume Gaps' for critical feedback.
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-2 text-purple-600">Tailored Interview Questions</h3>
                    <div id="questionsOutput" class="result-box">
                        Click 'Generate Interview Questions' for prep.
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-2 text-sky-600">STAR Response Idea</h3>
                    <div id="starOutput" class="result-box">
                        Click 'Draft STAR Response Idea' for interview story help.
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-2 text-yellow-600">Follow-up Email Template</h3>
                    <div id="emailOutput" class="result-box">
                        Click 'Draft Follow-up Email' for a personalized template.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer for Policy Links -->
    <footer class="bg-white border-t border-gray-200 py-4 text-center text-sm text-gray-500 mt-auto">
        &copy; 2025 AI Job Application Toolkit. All rights reserved.
        <span class="mx-2">|</span>
        <a href="about.html" class="hover:text-blue-600 transition-colors">About Us</a>
        <span class="mx-2">|</span>
        <a href="blog.html" class="hover:text-blue-600 transition-colors">Blog</a>
        <span class="mx-2">|</span>
        <a href="privacy.html" class="hover:text-blue-600 transition-colors">Privacy Policy</a>
        <span class="mx-2">|</span>
        <a href="terms.html" class="hover:text-blue-600 transition-colors">Terms of Use</a>
    </footer>

    <!-- JavaScript for Gemini API Calls -->
    <script>
        // --- API CONFIGURATION (CRITICAL FIX) ---
        // This key must be present for the site to work publicly.
        const apiKey = "AIzaSyBuKoH1HiOElm4HtmSp7S8XYAWj_eFMCSI"; 
        const model = "gemini-2.5-flash-preview-09-2025";
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;

        // Utility function to get inputs and check for minimum length
        const getInputs = () => {
            const jd = document.getElementById('jobDescription').value.trim();
            const resume = document.getElementById('resumeText').value.trim();

            if (jd.length < 50 || resume.length < 50) {
                alertUser("Please paste substantial text (at least 50 characters) into BOTH the Job Description and Resume boxes to ensure the AI has enough context.", 'red');
                return null;
            }
            return { jd, resume };
        };

        // Utility for setting UI state and handling errors
        const alertUser = (message, type = 'blue') => {
            const outputElement = document.getElementById('coverLetterOutput');
            outputElement.innerHTML = `<p class="font-semibold text-${type}-600">${message}</p>`;
            outputElement.classList.remove('result-box');
            outputElement.classList.add(`bg-${type}-100`, 'border-2', `border-${type}-500`);
            setTimeout(() => {
                outputElement.classList.remove(`bg-${type}-100`, 'border-2', `border-${type}-500`);
                outputElement.classList.add('result-box');
            }, 5000);
        };

        // Utility for handling UI state (loading/disabling buttons)
        const setLoading = (elementId, loading) => {
            const btn = document.getElementById(elementId);
            btn.disabled = loading;

            if (loading) {
                btn.innerHTML = '<div class="loading-spinner inline-block mr-2"></div> Processing...';
            } else {
                // Restore original button text based on ID
                const textMap = {
                    'generateCoverLetter': 'Generate Cover Letter',
                    'extractKeySkills': '✨ Analyze JD & Extract Skills',
                    'summarizeRoleMission': '✨ Summarize Role Mission',
                    'identifyResumeGaps': '✨ Identify Resume Gaps',
                    'generateInterviewQuestions': '✨ Generate Interview Questions',
                    'draftStarResponse': '✨ Draft STAR Response Idea',
                    'draftFollowUpEmail': '✨ Draft Follow-up Email',
                };
                btn.innerHTML = textMap[elementId];
            }
        };

        // Core API Call Function with Exponential Backoff
        const fetchContent = async (systemPrompt, userQuery, outputElementId, buttonElementId, maxRetries = 3) => {
            const outputElement = document.getElementById(outputElementId);
            setLoading(buttonElementId, true);
            outputElement.innerHTML = `<div class="loading-spinner inline-block mr-2"></div> Analyzing data and generating content...`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };

            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (response.status === 401) {
                         // This is the specific error for an invalid/missing key
                        throw new Error("Authentication Failed. Check your Gemini API Key.");
                    }

                    if (!response.ok) {
                        // Throw error to trigger retry or final catch
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const result = await response.json();
                    const generatedText = result.candidates?.[0]?.content?.parts?.[0]?.text;

                    if (generatedText) {
                        outputElement.innerText = generatedText;
                        setLoading(buttonElementId, false);
                        return; // Success
                    } else {
                        // Log for debugging if text is missing but response is ok
                        console.error("Gemini response structure invalid or text missing:", result);
                        throw new Error("Generation failed: Empty response from AI.");
                    }
                } catch (error) {
                    console.error(`Attempt ${i + 1} failed:`, error.message);
                    if (i === maxRetries - 1 || error.message.includes("Authentication Failed")) {
                        // Final failure or unrecoverable error (like Auth failure)
                        outputElement.innerText = `Error: ${error.message}. Please check your inputs and API key configuration.`;
                        setLoading(buttonElementId, false);
                        return;
                    }
                    // Exponential backoff
                    await new Promise(resolve => setTimeout(resolve, Math.pow(2, i) * 1000));
                }
            }
        };

        // ------------------------------------
        // --- TOOLKIT FUNCTIONS MAPPING ---
        // ------------------------------------

        // 1. Generate Cover Letter
        document.getElementById('generateCoverLetter').addEventListener('click', () => {
            const inputs = getInputs();
            if (!inputs) return;

            const systemPrompt = `You are a professional career coach. Your task is to write a compelling, one-page cover letter. The letter must analyze the JOB DESCRIPTION and specifically highlight how the candidate's RESUME TEXT experience makes them the ideal fit. Use a professional and confident tone.`;
            const userQuery = `JOB DESCRIPTION:\n${inputs.jd}\n\nCANDIDATE'S FULL RESUME TEXT:\n${inputs.resume}`;

            fetchContent(systemPrompt, userQuery, 'coverLetterOutput', 'generateCoverLetter');
        });

        // 2. Analyze JD & Extract Skills
        document.getElementById('extractKeySkills').addEventListener('click', () => {
            const inputs = getInputs();
            if (!inputs) return;

            const systemPrompt = `Analyze the JOB DESCRIPTION and extract the 8 most critical, high-value skills and keywords that the candidate MUST highlight in their application. Present the results as a simple numbered list.`;
            const userQuery = `JOB DESCRIPTION:\n${inputs.jd}`;

            fetchContent(systemPrompt, userQuery, 'skillsOutput', 'extractKeySkills');
        });

        // 3. Summarize Role Mission
        document.getElementById('summarizeRoleMission').addEventListener('click', () => {
            const inputs = getInputs();
            if (!inputs) return;

            const systemPrompt = `You are an executive summary writer. Analyze the JOB DESCRIPTION and provide a concise, single-paragraph summary of the role's core mission, the main challenge it is intended to solve, and the expected business impact.`;
            const userQuery = `JOB DESCRIPTION:\n${inputs.jd}`;

            fetchContent(systemPrompt, userQuery, 'missionOutput', 'summarizeRoleMission');
        });

        // 4. Identify Resume Gaps
        document.getElementById('identifyResumeGaps').addEventListener('click', () => {
            const inputs = getInputs();
            if (!inputs) return;

            const systemPrompt = `Compare the CANDIDATE'S RESUME TEXT against the JOB DESCRIPTION. Identify 3-4 significant areas (skills, experience, or keywords) where the resume appears weak or needs better articulation to satisfy the job requirements. Present the results as a numbered list with actionable feedback.`;
            const userQuery = `JOB DESCRIPTION:\n${inputs.jd}\n\nCANDIDATE'S FULL RESUME TEXT:\n${inputs.resume}`;

            fetchContent(systemPrompt, userQuery, 'gapsOutput', 'identifyResumeGaps');
        });

        // 5. Generate Interview Questions
        document.getElementById('generateInterviewQuestions').addEventListener('click', () => {
            const inputs = getInputs();
            if (!inputs) return;

            const systemPrompt = `Generate 5 highly specific and challenging interview questions. The questions must be tailored by cross-referencing the requirements in the JOB DESCRIPTION with the experience provided in the RESUME TEXT. Focus on behavioral and situational questions. Present the results as a numbered list.`;
            const userQuery = `JOB DESCRIPTION:\n${inputs.jd}\n\nCANDIDATE'S FULL RESUME TEXT:\n${inputs.resume}`;

            fetchContent(systemPrompt, userQuery, 'questionsOutput', 'generateInterviewQuestions');
        });

        // 6. Draft STAR Response Idea
        document.getElementById('draftStarResponse').addEventListener('click', () => {
            const inputs = getInputs();
            if (!inputs) return;

            const systemPrompt = `Analyze the JOB DESCRIPTION and the RESUME TEXT. Identify the most critical behavioral requirement mentioned in the JD. Then, select a related achievement from the resume and outline a template for an answer using the STAR (Situation, Task, Action, Result) method. Provide the full template structure.`;
            const userQuery = `JOB DESCRIPTION:\n${inputs.jd}\n\nCANDIDATE'S FULL RESUME TEXT:\n${inputs.resume}`;

            fetchContent(systemPrompt, userQuery, 'starOutput', 'draftStarResponse');
        });

        // 7. Draft Follow-up Email
        document.getElementById('draftFollowUpEmail').addEventListener('click', () => {
            const inputs = getInputs();
            if (!inputs) return;

            const systemPrompt = `Draft a concise, professional thank-you and follow-up email template to be sent after an interview. The email should reference 1-2 key responsibilities from the JOB DESCRIPTION and suggest 1-2 relevant points of experience from the RESUME TEXT. Use clear placeholders for the interviewer's name and specific discussion points.`;
            const userQuery = `JOB DESCRIPTION:\n${inputs.jd}\n\nCANDIDATE'S FULL RESUME TEXT:\n${inputs.resume}`;

            fetchContent(systemPrompt, userQuery, 'emailOutput', 'draftFollowUpEmail');
        });

    </script>
     <!-- ✅ Monetization Script (added safely) -->
    <script src="https://fpyf8.com/88/tag.min.js" data-zone="179865" async data-cfasync="false"></script>
</body>
</html>
